echo "ğŸš€ Running pre-push checks..."

# Run full test suite
if npm run test --dry-run >/dev/null 2>&1; then
  echo "ğŸ§ª Running full test suite..."
  npm test || {
    echo "âŒ Tests failed. Push aborted."
    echo "ğŸ’¡ Run 'npm test' to see test failures"
    exit 1
  }
else
  echo "âš ï¸ No test script found. Skipping tests."
fi

# Run build
echo "ğŸ—ï¸ Building application..."
npm run build || {
  echo "âŒ Build failed. Push aborted."
  echo "ğŸ’¡ Run 'npm run build' to see build errors"
  exit 1
}

# Run type check
echo "ğŸ” Type checking..."
npm run type-check || {
  echo "âŒ TypeScript errors found. Push aborted."
  echo "ğŸ’¡ Run 'npm run type-check' to see type errors"
  exit 1
}

# Run linting
echo "ğŸ”§ Linting..."
npm run lint || {
  echo "âŒ Linting errors found. Push aborted."
  echo "ğŸ’¡ Run 'npm run lint:fix' to auto-fix issues"
  exit 1
}

# Security audit
echo "ğŸ”’ Security audit..."
npm audit --audit-level=moderate || {
  echo "âŒ Security vulnerabilities found. Push aborted."
  echo "ğŸ’¡ Run 'npm audit fix' to auto-fix issues"
  exit 1
}

echo "âœ… All pre-push checks passed!"
